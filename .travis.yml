language: java
jdk: oraclejdk8

install:
- mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
script:
- mvn test

deploy:
 provider: script
 script: sh ./deployCleverCloud.sh
on:
 branch:master

addons:
  sonarcloud:
    organization: "eriwyr-github" # the key of the org you chose at step #3
    token:
      secure: PDdDoLTIH6KL+5DMGl3uiMm/ufWVLcH15NyuisZnmu3Xf25P5LOuPLpd2PxKAHlxKOtnAhzpenbJix91W5XTXqHQaTs1Cf6zpqvTnVAd7VLisv/gJnUSt9DK+jF+68uG16hLacv47qG7tNwg8O6V2EyWw9vEVjvN5fiIbJKzF6Xdt+aAplBu8VeWsOJVyuDQB1uJ4gqodoAyJFj10e73RGDXaNgy0ta0B8gqzd3mYtZyAZQdUbHUahAAhY/T1CfC39BG9gDFI+PDYkilJAQX7XJawTxvms/8peMobXv4LjUgFmkr8QG+geWKG9I7CgZ2cCDWfbPJeXSwd750b9Qbh2wk+2bn+HEvlQHqW3tegQ1QUYmEnUFRZsS4dyNFDOoQHSTDy1RpwBAjIceIsiDJoHbPe4+zMKL8SJu/YbyewDH31MjmfVV37HBantTFgpnZJ6HPa8mXM/KASO1fVnI9R5zYtgaLvZHDZ8C/LPTDhJy8mWoblCbz0WhqyfTBaZcA8KmW48wr5l6uJKcPNHJ4OshQw3Q3jc9Aui5vVxeMXAJX6v4PUKzMOqJdTFlSOKYOutvmm7e77BJzEw8GHZenUr3KouKWl9D6Q7fZ9qoccl3lKKlsc/qERhl0FL4WhdqP1KbA4FFKLiNlAqyfEDI1RAizhqyFUxcXbPM8HDp2bgg= # encrypted value of your token
script:
  # the following command line builds the project, runs the tests with coverage and then execute the SonarCloud analysis
  - mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar -Dsonar.host.url=https://sonarcloud.io

notifications:
  email:
    recipients:
      - chabrier.valentin@gmail.com
      - maxencebernier@hotmail.fr
      - clasenkristoffer@gmail.com
  slack:
    rooms:
      - secure : GP2MVaJYuDZNZm+xQVYMWstzIGrgSni0oL1cRmRqf8icFCyHITLg2DK78GijO1ZAGHkzsvwPyisz33f+6eJ9PLG0dYFGbtfRLDHMT6Y6lMgosh9lpcCDwZGtf77Txo/mQZTBiTe7VsM2hAjvZSueCXghg97KIOypTq7JFWxznh4rCv5imKqRd34ixFM/gJzMVDiR2I+Zbw4uknwR+dWWkjSYwDQFe6eU05roCX2LZe1HQaaWQ6FHqgpaHuCBAwszZMD1XOq4s3z7wNhnluHNdXeSg4Zmua3bQD+CiN5421elZ1XdzGB2YBxb0szb/gHpwI+r1amOIn0781LNNbpctxRW1ZziAmcrS7aIhXUbwrswcLz3htvZHTNQBrix0m9OQni9rmrP6FFeMvCnq/Wm3YEBpO4e++cYMrymI7SLFTDBNtiVouunR5SZP+HxFxIqO2DbWehNyUZAOjnLxcsV8Dj97EWAj7Rf1QJ9sp7Iiz8FEFyZ2DPmP8tKM9AqcdufZgWXeVCG0C6jlWkqrJF29G6ZVkO5DniNm7y5R7pVSCb2STGFcRj3upYFz35XBzuZBGLG1K063zbNuT7VBfYqGp4lYb4nhlkVD0/inBQp6eMFXrZP5eJ1MjZNgsORM/4b0LiOfyUErTO4dyjMWrwrumUaWCqASCp4OQt2j7PYsWA=
    on_success: always
    on_failure: always
    template : 
      - "Repo `%{repository_slug}` *%{result}* build (<%{build_url}|#%{build_number}>) for commit (<%{compare_url}|%{commit}>) on branch `%{branch}`."
      - "Execution time: *%{duration}*"
      - "Message: %{message}"

cache:
  directories:
  - .autoconf
  - $HOME/.m2

addons:
 ssh_known_hosts:
 - push-par-clevercloud-customers.services.clever-cloud.com
