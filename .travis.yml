language: java
jdk: oraclejdk8
dist: trusty

install:
- mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

addons:
  sonarcloud:
    organization: "eriwyr-github"
    token:
      secure: "lolX8+kyRKCU94qkIdfIT72SYI/g4Hi4Pdqtw95hcWlYAhzTM5L4FDaJxeKXKz6sjGbWH4ZmXglRbaNGiUdDHnzkeg5S85y9nZP/D48Qj2cjDvj/5B0u4IwE8zKJoDb2hHtny/cOM+wzEuLH5RLw+LDTDFrtDTthLj4m33hlk5w1JXaLKoT6JK2cplVPiWgVYNgF8xR6CrmBJGQIPUBdSPuPH47lUR0LEaonQVKpS4HeTPDC29mjIzOSBz9c3tgbopDcVUKV9QxpGtYwe/9Gtr4/dZ6YijEmgxCo45s6YLM6thsgAOHXH61T0yDVjdqNYr/xITdLZ2Lze3XdCa2VUWtzmCL+2u0iCqq7+zg3UPtt02/s9W6+rRHjnXH1VM/3OU/nxc8ai2vxHNkOzJHOq8wHjd+d0m2NPMxQQm+2uPSdSgpXhQSj8mBnN8qYY6ShNqAudHYMrNYylZjppIdfDFp6SxdREfl4/ShSyv6Uad4n127amaKiPIcXhOWC9J1+JmqD2MtlAuf6eHK5vivEoYS6LAuO+skYFLBdzCnRlbi87Jmgf0p78hy+00kkKLWfgx3O3gMx66dtl57XYy8cIqiBasftPkxJBcQZqlRzqNc0r06EE5CXzvOG5i1f+scc7S1rzkoNxTjlHAqCx1YsyrxdKWpNepaUGoLRuSIFJVDB50="
script:
- mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar -Dsonar.host.url=https://sonarcloud.io 

deploy:
 provider: script
 script: sh ./deployCleverCloud.sh
on:
 branch:master

notifications:
  email:
    recipients:
      - chabrier.valentin@gmail.com
      - maxencebernier@hotmail.fr
      - clasenkristoffer@gmail.com
  slack:
    rooms:
      - secure : GP2MVaJYuDZNZm+xQVYMWstzIGrgSni0oL1cRmRqf8icFCyHITLg2DK78GijO1ZAGHkzsvwPyisz33f+6eJ9PLG0dYFGbtfRLDHMT6Y6lMgosh9lpcCDwZGtf77Txo/mQZTBiTe7VsM2hAjvZSueCXghg97KIOypTq7JFWxznh4rCv5imKqRd34ixFM/gJzMVDiR2I+Zbw4uknwR+dWWkjSYwDQFe6eU05roCX2LZe1HQaaWQ6FHqgpaHuCBAwszZMD1XOq4s3z7wNhnluHNdXeSg4Zmua3bQD+CiN5421elZ1XdzGB2YBxb0szb/gHpwI+r1amOIn0781LNNbpctxRW1ZziAmcrS7aIhXUbwrswcLz3htvZHTNQBrix0m9OQni9rmrP6FFeMvCnq/Wm3YEBpO4e++cYMrymI7SLFTDBNtiVouunR5SZP+HxFxIqO2DbWehNyUZAOjnLxcsV8Dj97EWAj7Rf1QJ9sp7Iiz8FEFyZ2DPmP8tKM9AqcdufZgWXeVCG0C6jlWkqrJF29G6ZVkO5DniNm7y5R7pVSCb2STGFcRj3upYFz35XBzuZBGLG1K063zbNuT7VBfYqGp4lYb4nhlkVD0/inBQp6eMFXrZP5eJ1MjZNgsORM/4b0LiOfyUErTO4dyjMWrwrumUaWCqASCp4OQt2j7PYsWA=
    on_success: always
    on_failure: always
    template : 
      - "Repo `%{repository_slug}` *%{result}* build (<%{build_url}|#%{build_number}>) for commit (<%{compare_url}|%{commit}>) on branch `%{branch}`."
      - "Execution time: *%{duration}*"
      - "Message: %{message}"

cache:
  directories:
  - .autoconf
  - $HOME/.m2
  - $HOME/.sonar/cache

addons:
 ssh_known_hosts:
 - push-par-clevercloud-customers.services.clever-cloud.com
